# Patch Analysis Configuration - Version 6
# Configuration for flux contribution analysis and flare detection
# Version 6: Uses DBSCAN clustering for region detection

# Data paths
base_data_dir: "/data/FOXES_Data/batch_results/vit/"
flux_path: "${base_data_dir}/flux"
aia_path: "/data/FOXES_Data/AIA"
output_path: "${base_data_dir}/vit_predictions_all.csv"

# Grid and patch parameters
grid_size: [64, 64]
patch_size: 8
input_size: 512

# Analysis parameters
analysis:
  # Time period for analysis
  time_period:
    start_time: "2012-02-01T00:00:00"
    end_time: "2012-02-09T23:59:59"
  
  flare_detection:
    
    # Threshold for filtering patches before clustering (median + std_multiplier * std)
    threshold_std_multiplier: 3        # ORIGINAL - stable detection
    peak_neighborhood_size: 15         # ORIGINAL
    peak_assignment_max_distance: 5    # ORIGINAL
    flux_decrease_strictness: 0.5      # ORIGINAL
    
    # Region filtering
    min_flux_threshold: 0.0000001      # ORIGINAL
    
    # Temporal smoothing (applied to detected region flux values and sizes)
    flux_smoothing_window: 3           # Moderate smoothing (original was 1)
    
    flare_distance_relax_factor: 4.5   # ORIGINAL
    show_bright_patch_markers: true
    
    # Tracking continuity parameters (ONLY CHANGES FROM ORIGINAL)
    max_time_gap_minutes: 180          # INCREASED: Bridge 3-hour gaps (was 60)
    min_track_detections: 1            # Keep requiring 2+ detections
    
    # Simultaneous flare detection
    simultaneous_flare_threshold: 0.000001
    sequence_window_hours: 1.0
  
  # Output configuration
  output:
    output_dir: "${base_data_dir}/patch_analysis_output_test"
    
    # Movie generation
    create_contour_movie: false
    create_simultaneous_flare_movies: false
    create_contour_movies_for_sequences: false
    create_flux_heatmap_movies_for_sequences: false
    simultaneous_window_hours: 1
    movie_fps: 15
    movie_interval_seconds: 12
    show_sxr_timeseries: true
    max_tracking_distance: 20  # Slightly increased from 15 for better tracking
